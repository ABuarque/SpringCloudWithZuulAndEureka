version: "3.4"

services:
  gateway:
    build: .
    ports:
    - "8502:8502"
    links:
    - "server-api:server-api"
    - "client-api:client-api"
    environment:
      - USER_SERVER_ENDPOINT=http://server-api:8500
      - ANALYSIS_SERVER_ENDPOINT=http://client-api:8501

  server-api:
    build: ../api-server
    ports:
      - "8500:8500"

  client-api:
    ports:
      - "8501:8501"
    links:
      - "server-api:server-api"
    environment:
      - MY_SERVER_HOST=server-api
      - MY_SERVER_PORT=8500
      - MY_VALUE=http://server-api:8500
    build: ../api-client
